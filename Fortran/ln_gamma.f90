	function ln_gamma(z) result(f)
! ln_gamma  Computes the logarithm of the Gamma function in the entire complex plane
!
!   f = ln_gamma(z) returns log(Gamma(z)) for any complex input z.
!   The input z has to be a scalar (this code is not vectorized)
!
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
! Author: Alexey Kuznetsov
! York University, Toronto, Canada
! Website: https://kuznetsovmath.ca/
! Email: akuznets@yorku.ca
!
! Created: 28-Nov-2025
! Last updated: 28-Nov-2025
!
! License: BSD 3-Clause (https://opensource.org/licenses/BSD-3-Clause)
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 	
	implicit none
	complex(kind=16), intent(in)	:: z
	complex(kind=16)		:: f, w
	integer				:: k
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  real(kind=16), parameter	:: pi_16=3.141592653589793238462643383279502884q0
  complex(kind=16), parameter	:: i_16=(0.0q0,1.0q0) 
  complex(kind=16), parameter	:: c(1:10)=&  
  (/(-6.32899264378083954638419690213358305q-19,-5.02618515225831864524291125577114754q-19),&
    (9.00118789519049878055317954964612560q-16,1.18043955890013107152066865403796443q-15),&
    (-4.29204799869012678130788469868436316q-14,-4.66621190267878627507686221512522336q-13),&
    (-3.06993266002176329741933845106314762q-11,4.58256502470738272942404661111310553q-11),&
    (3.20896062831335555334601331074941425q-9,-8.45570160599064823800107884664011153q-10),&
    (-1.09470182714659777673083157232597235q-7,-5.24436125117097128364528129393000065q-8),&
    (1.47528847671109786357817665562717741q-6,-2.65586627509694548648297660078199290q-6),&
    (-5.50768797120583008282927935725546637q-6,5.81608431331109985941637330149412975q-5),&
    (4.31122232694993407331819857083550188q-4,1.11921275658933787495833864997198982q-3),&
    (-2.41037222250212947178816411812599360q-9,-4.21699693059619209244770449485032864q-9)/)
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
   real(kind=16), parameter 	:: c_r(1:10)=&  
   (/-2.00169371367851077240921611133845440q-3,&   
     1.43128980975431349878973832819745521q-3,&  
     8.69393952658216645174904902551239677q-4,&   
     -5.41543864782889254528473496920294957q-4,&  
     -6.98972526780601311534472208134570921q-4,&   
     -6.02535738432353374274741775542021765q-4,& 
     -4.02426638590669366133087883380795036q-4,&
     -2.08082060765028076175427617315967047q-4,&   
     -7.51589218439833233388701348386165060q-5,&   
     -1.31214481570680189526382098899024992q-5/)   
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   complex(kind=16), parameter	:: lambda(1:10)=&  
   (/(6.15772691848436302117950334290956840q0,5.82678927522618136678128661545234970q0),& 
     (5.70615059581813427304565174124639501q0,4.57767378167759699020117820108089056q0),& 
     (5.30370779721225742665966313861552107q0,3.63037687497795980682021854514944400q0),& 
     (4.92088169519527369357869627612543856q0,2.84880842625788893914763257537801717q0),& 
     (4.54514250023857218026370650640521016q0,2.17931076980339710121742097822727628q0),& 
     (4.16751786754127005568543614893858217q0,1.59323074506298371504158985275637993q0),& 
     (3.77782853497654937912120172342150212q0,-1.07224418246785135369876203150328604q0),& 
     (3.35848914848803730410049013333407534q0,-6.01249735439710145730606107292408783q-1),& 
     (2.85117399421515274972075545340518913q0,1.58182551673758068922716182867928173q-1),& 
     (2.11951140814251496765423382357130447q0,-6.91198414476815744877210668869951012q-1)/)
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    
   real(kind=16), parameter	:: lambda_r(1:10)=&  
   (/2.21771976816897749191699587269624580q0,& 
    1.81418432423509982786230354779162763q0,& 
    1.64516199407584064978689467741899988q0,& 
    1.37707044937426736953581755343856311q0,& 
    1.27428377575649369564587907893861732q0,& 
    1.18984188810634545941949504290129028q0,& 
    1.12226750115995944208083314090584000q0,& 
    1.07035206271462406505484513395398115q0,& 
    1.03311805263012155459126730383420396q0,& 
    1.00981307264980725643979710105875975q0/)
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	if (z%re>1.5q0) then
		f=sum(c/(z-1+lambda)**3+conjg(c)/(z-1+conjg(lambda))**3+c_r/(z-1+lambda_r)**3)  
		f=2*f+(z-0.5q0)*log(z)-z+1/(12*z)+0.5q0*log(2*pi_16)
	elseif (z%re>0.5q0) then ! use the functional equation log(Gamma(z))=log(Gamma(z+1))-log(z)	
		f=sum(c/(z+lambda)**3+conjg(c)/(z+conjg(lambda))**3+c_r/(z+lambda_r)**3)  
		w=z+1;
		f=(2*f+(w-0.5q0)*log(w)-w+1/(12*w)+0.5q0*log(2*pi_16))-log(z)
	elseif (z%im>=0.0q0) then ! use reflection formula
		w=2-z
		f=sum(c/(w-1+lambda)**3+conjg(c)/(w-1+conjg(lambda))**3+c_r/(w-1+lambda_r)**3)	
		f=log(1-z)-(2*f+(w-0.5q0)*log(w)-w+1/(12*w))+0.5q0*log(2*pi_16)+pi_16*i_16*(z-0.5q0)-log(1-exp(2*pi_16*i_16*z))
	else 	 ! use reflection formula
		w=2-z
		f=sum(c/(w-1+lambda)**3+conjg(c)/(w-1+conjg(lambda))**3+c_r/(w-1+lambda_r)**3)	
		f=log(1-z)-(2*f+(w-0.5q0)*log(w)-w+1/(12*w))+0.5q0*log(2*pi_16)-pi_16*i_16*(z-0.5q0)-log(1-exp(-2*pi_16*i_16*z))	
	end if
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	end function ln_gamma
